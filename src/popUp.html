<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
</head>
<style>
    body{
    height: 100%;
    margin: 0;
    background-color: white;
}
.snakeGame{
    width: 600px;
    height: 400px;
    border: 1px solid black;
    background-color:  #4fc3f7;;
    box-shadow: 0 0 5px rgb(240, 220, 220);
    border-radius: 0.5em / 0.5em;
}

.bgimg{
    height: 100%;
    color: black;
    font-family: 'Courier New', Courier, monospace;
    font-size: 30px;
}

.middle{
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.sidenav {
    height: 100%;
    width: 0%;
    position: fixed;
    z-index: 1;
    top: 0;
    left: 0;
    background-color:  #4fc3f7;;
    overflow: hidden;
    transition: 0.5s;
    padding-top: 60px;
    color: white;
}
  
.sidenav .closebtn {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 36px;
    margin-left: 50px;
}
  
#main {
    transition: margin-left .5s;
    padding: 16px;
}
</style>
<body>

<div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <p style="font-size: 25px; font-weight: bold;"> How to Play the Snake Game??</p>
    <p>
      Two boxes are representing the snake and the fruit. When one box crosses the other box the length of the box will increase and the score will update to 1 while the two cross each other. The process performed like this until the snake collision itself then the game is over. 
    </p>
    <p style="font-size: 20px; font-weight: bold;">
        The user can start the game again after press the button OK.
    </p> 
  </div>
  
  <div id="main">
    <span style="font-size:20px;cursor:pointer" onclick="openNav()">&#9776;</span>
  </div>

    <div class="bgimg">
        <div class="middle">
            <div class="score"></div>
            <canvas class="snakeGame"></canvas>
        </div>
    </div>
</body>

<script>
    const canvas = document.querySelector(".snakeGame");
const ctx = canvas.getContext("2d");
const scale = 10;

const rows = canvas.height / scale;
const column = canvas.width / scale;

var snake;

//function to draw fruit 
//let small box represent a fruit in this case
function Fruit() {
    this.x;
    this.y;
  
    this.pickLocation = function() {
      this.x = (Math.floor(Math.random() *
        column - 1) + 1) * scale;
      this.y = (Math.floor(Math.random() *
        rows - 1) + 1) * scale;
    }
  
    this.draw = function() {
      ctx.fillStyle = "white";
      ctx.fillRect(this.x, this.y, scale, scale)
    }
}

//draw snake
function drawSnake(){
    this.x = 0;
    this.y = 0;
    this.xSpeed = scale*1;
    this.ySpeed = 0;
    this.total = 0;
    this.tail = [];


    this.draw = function(){
        ctx.fillStyle='green';  //set color for snake 

        for (let i=0; i<this.tail.length; i++){     //increase length of snake start from tail
            ctx.fillRect(this.tail[i].x, this.tail[i].y, scale, scale);
        }

        ctx.fillRect(this.x, this.y, scale, scale);  
    }

    this.update = function(){       //function for updating the snake

        for (let i=0; i<this.tail.length-1; i++){
            this.tail[i] = this.tail[i+1];
        }

        this.tail[this.total -1] = {x: this.x, y:this.y};

        this.x += this.xSpeed;
        this.y += this.ySpeed;

        if(this.x < 0){
            this.x = canvas.width;
        }
        if(this.y < 0){
            this.y = canvas.height;
        }
        if(this.x > canvas.width){
            this.x = 0;
        }
        if(this.y > canvas.height){
            this.x = 0;
        }
    }

    this.changeDirection = function(direction){
        switch(direction){
            case 'Left': 
                this.xSpeed = -scale*1;
                this.ySpeed = 0;
                break;
            case 'Right': 
                this.xSpeed = scale*1;
                this.ySpeed = 0;
                break;
            case 'Up': 
                this.xSpeed = 0;
                this.ySpeed = -scale*1;
                break;
            case 'Down': 
                this.xSpeed = 0;
                this.ySpeed = scale*1;
                break;
        }
    }

    //function inscrease size of snake
    this.eat = function(fruit){
        if(this.x == fruit.x && this.y == fruit.y){
            this.total++;
            return true;
        }
        return false
    }

    //function for check collision and end game 
    this.checkCollision= function(){
        for(var i=0; i<this.tail.length; i++){
            if(this.x == this.tail[i].x && this.y == this.tail[i].y){
                this.total = 0;
                this.tail=[];
                alert('You lost and Press OK to continue the playing')
            }
        }
    }
}

(function setup(){
    snake = new drawSnake();
    fruit = new Fruit();

    fruit.pickLocation();

    window.setInterval(() => {
        ctx.clearRect(0, 0, canvas.width, canvas.height); 
        fruit.draw();
        snake.update();
        snake.draw();

        //improve performance of snake 
        //if snake touch the box it will increase size
        if(snake.eat(fruit)){
            fruit.pickLocation();
        }
        snake.checkCollision();     //will end game after snake collision
        document.querySelector('.score').innerHTML = snake.total;
    }, 250);
}());

//use keyboard to control the performance
window.addEventListener('keydown', ((evt) => {
    console.log(evt);
    const direction = evt.key.replace('Arrow', '');
    snake.changeDirection(direction)
}))

</script>
<!--<script src="../assets/js/snake.js"></script>-->

<!--
<script>
    function openNav() {
      document.getElementById("mySidenav").style.width = "250px";
      document.getElementById("main").style.marginLeft = "250px";
      document.body.style.backgroundColor = "white";
    }

    function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
    document.getElementById("main").style.marginLeft= "0";
    document.body.style.backgroundColor = "white";
    } -->

</html>